<p id="variant-sku">SKU: {{ product.variants.first.sku }}</p>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const skuDisplay = document.getElementById('variant-sku');
    const productData = {{ product | json }};
    let lastCheckedId = null;

    function updateSkuById(variantId) {
      const matchedVariant = productData.variants.find(v => v.id == variantId);
      if (matchedVariant) {
        skuDisplay.textContent = matchedVariant.sku ? 'SKU: ' + matchedVariant.sku : 'SKU: N/A';
      }
    }

    function getCurrentVariantId() {
      // Try radio buttons first
      const radioChecked = document.querySelector('input[name="id"]:checked');
      if (radioChecked) return radioChecked.value;

      // Try select dropdown
      const select = document.querySelector('select[name="id"]');
      if (select) return select.value;

      return null;
    }

    setInterval(() => {
      const currentId = getCurrentVariantId();
      if (currentId && currentId !== lastCheckedId) {
        lastCheckedId = currentId;
        updateSkuById(currentId);
      }
    }, 300); // checks every 300ms for better responsiveness
  });
</script>
