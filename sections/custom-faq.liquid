{% comment %} DYNAMIC FAQ WITH CATEGORY FILTER {% endcomment %}

<div style="display: flex; flex-direction: column; gap: 1.25rem; width: 100%; border-top: 2px solid #000; padding-top: 2rem;">
  <div style="display: flex; flex-direction: column; align-items: center; margin-bottom: 6rem; text-align: center;">
    <h1 style="text-transform: uppercase;">Frequently Asked Questions</h1>
    <span>Find quick answers to common questions about your order, shipping, returns, and more.</span>
  </div>

  {% assign categories = section.blocks | map: 'settings' | map: 'category' | uniq %}
  <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; margin-bottom: 2rem;" id="faq-categories">
    {% for category in categories %}
      <button data-category="{{ category | escape }}" style="border: 1px solid black; color: black; padding: 0.5rem 1rem; text-transform: uppercase; font-size: 1rem; background: none; cursor: pointer; transition: background 0.3s, color 0.3s;">
        {{ category }}
      </button>
    {% endfor %}
  </div>

  <div id="faq-list">
    {% for block in section.blocks %}
      <div class="faq-item" data-category="{{ block.settings.category | escape }}" style="border: 2px solid black; padding: 1rem; margin-bottom: 1rem; transition: all 0.3s ease;">
        <button type="button" class="faq-toggle" style="display: flex; justify-content: space-between; align-items: center; width: 100%; background: none; border: none; font-size: 1rem; cursor: pointer;">
          <span style="font-weight: 500;">{{ block.settings.question }}</span>
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer" style="display: none; margin-top: 0.5rem;">
          <p>{{ block.settings.answer }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggleButtons = document.querySelectorAll(".faq-toggle");
    const categoryButtons = document.querySelectorAll("[data-category]");

    toggleButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const item = btn.closest(".faq-item");
        const answer = item.querySelector(".faq-answer");
        const icon = btn.querySelector(".faq-icon");
        const isOpen = answer.style.display === "block";

        answer.style.display = isOpen ? "none" : "block";
        icon.textContent = isOpen ? "+" : "âˆ’";
      });
    });

    categoryButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const category = btn.getAttribute("data-category");
        document.querySelectorAll(".faq-item").forEach(item => {
          item.style.display = item.getAttribute("data-category") === category ? 'block' : 'none';
        });
      });
    });
  });
</script>

{% schema %}
{
  "name": "Custom FAQ",
  "tag": "section",
  "settings": [],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "category",
          "label": "Category",
          "default": "Orders"
        },
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How do I place an order?"
        },
        {
          "type": "textarea",
          "id": "answer",
          "label": "Answer",
          "default": "You can place an order by adding items to your cart and proceeding to checkout."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom FAQ",
      "blocks": [
        { "type": "faq_item" },
        { "type": "faq_item" }
      ]
    }
  ]
}
{% endschema %}