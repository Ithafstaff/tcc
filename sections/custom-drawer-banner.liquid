<section class="x:mt-8 section-blends section-full">
  {% comment %}
  <sl-drawer label="" class="drawer-overview-{{ section.id }}">
    <div slot="label">
      <div
        class="x:absolute x:w-full x:z-[-1] x:flex x:item-center x:justify-center x:tracking-widest x:text-sm" style="font-size: 14px;"
      >
        GET THE LOOK
      </div>
      &nbsp;
    </div>
    <div
      id="product-container-{{ section.id }}"
      class="x:grid x:grid-cols-2 x:gap-x-[15px] x:gap-y-[20px] x:p-[20px] x:md:p-[40px] x:pb-[40px]"
    >
      {% for product in section.settings.collection.products %}
        <a href="{{ product.url }}" class="x:w-full x:flex x:flex-col">
          <div
            class="x:w-full x:aspect-square x:bg-cover x:bg-center x:mb-[8px] x:md:mb-[18px]"
            style="background-image: url('{{ product.featured_image.src | image_url: width: product.featured_image.width }}')"
          >
            &nbsp;
          </div>
          <div class="x:flex x:flex-col x:justify-between x:gap-[8px] x:flex-grow x:items-start">
            <div class="x:space-y-[2px] x:md:space-y-[5px]">
              <p class="x:text-[12px] x:md:text-[14px] x:leading-[16px] x:md:leading-[20px]">
                {{ product.title }}
              </p>
              <p class="x:text-[12px] x:leading-[18px] x:tracking-[-0.21px]">{{ product.price | money }}</p>
            </div>
            <button
              class="x:text-[#222] x:border x:border-solid x:border-black x:p-[6px] x:text-[12px] x:leading-[1.5] x:tracking-[1px] x:px-[10.5px] x:py-[3.5px] x:md:hidden"
            >
              ADD TO CART
            </button>
          </div>
        </a>
      {% endfor %}
    </div>
  </sl-drawer>
  {% endcomment %}
  <div class="custom-drawer__container">
    <div class="x:relative {% comment %}x:lg:max-w-[1650px]{% endcomment %} x:overflow-hidden x:rounded">
      <div
        class="x:bg-cover x:bg-no-repeat x:bg-center x:w-full x:aspect-square x:lg:aspect-[16/9]"
        style="background-image: url('{{ section.settings.image | image_url: width: 1000 }}'); max-height: 550px;"
      >
        <div class="x:absolute x:z-[1] drawer__button-container" style="left: 40px; bottom: 40px;">
          <button
    class="drawer-button-responsive {{ section.settings.collection }} drawer-button-{{ section.id }}"
    style="
      background-color: rgba(34, 34, 34, 0.7);
      color: white;
      aspect-ratio: 1 / 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 9999px;
      padding: 12px;
    "
  >
    <i
      class="bx bx-shopping-bag"
      style="
        font-size: 1rem;
        line-height: 0;
      "
    ></i>
    <p
      class="animate-on-scroll get-the-look"
      style="
        text-align: center;
        white-space: nowrap;
        display: none;
      "
    >
      GET THE LOOK
    </p>
  </button>
        </div>
      </div>
    </div>



    <div class="custom-drawer__collection-wrap">
        <div class="custom-drawer__product-container" style="display: none;">

          <span class="custom-drawer__heading-txt">
            <!-- GET THE LOOK -->
            TEST
          </span>

          <div
            id="product-container-{{ section.id }}"
            class="custom-drawer__product-wrap"
          >
            {% for product in section.settings.collection.products %}
              <a href="{{ product.url }}" class="x:w-full x:flex x:flex-col custom-drawer__product-item">
                <div
                  class="x:w-full x:aspect-square x:bg-cover x:bg-center x:mb-[8px] x:md:mb-[18px]"
                  style="background-image: url('{{ product.featured_image.src | image_url: width: product.featured_image.width }}')"
                >
                  &nbsp;
                </div>
                <div class="x:flex x:flex-col x:justify-between x:gap-[8px] x:flex-grow x:items-start">
                  <div class="x:space-y-[2px] x:md:space-y-[5px]">
                    <p class="x:text-[12px] x:md:text-[14px] x:leading-[16px] x:md:leading-[20px]">
                      {{ product.title }}
                    </p>
                    <p class="x:text-[12px] x:leading-[18px] x:tracking-[-0.21px]">{{ product.price | money }}</p>
                  </div>
                  <button
                    class="x:text-[#222] x:border x:border-solid x:border-black x:p-[6px] x:text-[12px] x:leading-[1.5] x:tracking-[1px] x:px-[10.5px] x:py-[3.5px] x:md:hidden"
                  >
                    ADD TO CART
                  </button>
                </div>
              </a>
            {% endfor %}
          </div>
        </div>
    </div>
    
    
    
  </div>
</section>

<style>
  sl-drawer.drawer-overview-{{ section.id }}::part(body) {
      padding: 0;
  }

  sl-drawer.drawer-overview-{{ section.id }}::part(title) {
      padding-left: 0;
  }

  .drawer-overview-{{ section.id }} {
      --size: 100%;
  }

  @media (width >=990px) {
      .drawer-overview-{{ section.id }} {
          --size: 40vw;
      }
  }

  .custom-drawer__container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media screen and (max-width: 767px) {
    .custom-drawer__container {
      padding-left: 20px;
      padding-right: 20px;
    }
  }



  .custom-drawer__collection-wrap {
    position: fixed;
    top: 0;
    z-index: 99;
    right: 0;
    background: #fff;
    border: 1px solid;
  }

  .custom-drawer__product-wrap {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    height: auto;
  }

  .custom-drawer__product-container {
    height: 100vh;
    overflow: scroll;
    padding: 70px 40px 40px;
  }

  .custom-drawer__heading-txt {
    position: absolute;
    width: 100%;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    text-align: center;
    padding: 20px;
    background: #fff;
    font-weight: 700px;
  }

  .custom-drawer__product-item {
    max-width: 245px;
    width: 100%;
  }
    
</style>

<script>
  $(window).on('load', function () {
    const drawer = document.querySelector('.drawer-overview-{{ section.id }}');
    $('button.drawer-button-{{ section.id }}').on('click', () => {
      drawer.show();
    });
  });
</script>

<style>
  /* Initial state (hidden) */
  .animate-on-scroll {
    width: 0px;
    padding-left: 20px;
    opacity: 0;
    transition: width 0.5s ease-in-out, padding-right 0.5s ease-in-out, opacity 0.5s ease-in-out;
    overflow-x: hidden;
  }

  /* When the element is visible */
  .animate-on-scroll.visible {
    width: auto;
    padding-right: 30px;
    opacity: 1;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const elements = document.querySelectorAll('.animate-on-scroll');

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting && entry.intersectionRatio === 1) {
            // Show when fully in view
            entry.target.classList.add('visible');
          } else {
            // Hide when out of view
            entry.target.classList.remove('visible');
          }
        });
      },
      {
        threshold: 1.0, // 100% in view to trigger
        rootMargin: '0px 0px -50px 0px', // Add padding before the bottom edge
      }
    );

    elements.forEach((element) => {
      observer.observe(element);
    });
  });
</script>

{% schema %}
{
  "name": "Drawer Banner (TCC)",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    }
  ],
  "presets": [
    {
      "name": "Drawer Banner (TCC)"
    }
  ]
}
{% endschema %}
